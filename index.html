<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Course Planner & GPA Calculator</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, select, button { margin: 5px; }
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 6px;
    }
    .overflow { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Course Manager & GPA Calculator</h2>

  <h3>Add Course</h3>
  <form id="courseForm">
    <input type="text" id="courseName" placeholder="Course Name" required>
    <input type="number" id="credits" placeholder="Credits" required>
    <select id="gradeLetter" required>
      <option value="">Grade</option>
      <option>S</option>
      <option>A</option>
      <option>B</option>
      <option>C</option>
      <option>D</option>
      <option>E</option>
      <option>F</option>
    </select>
    <select id="category" required>
      <option value="">Category</option>
      <option>Professional</option>
      <option>Free</option>
      <option>Engineering</option>
      <option>Science</option>
      <option>Humanities</option>
    </select>
    <input type="text" id="semester" placeholder="Semester (e.g. SEM 1)" required>
    <button type="submit">Add Course</button>
  </form>

  <h3>Course List</h3>
  <table id="courseTable">
    <thead>
      <tr>
        <th>Course</th><th>Credits</th><th>Grade</th><th>Category</th><th>Semester</th><th>Grade Point</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Credit Summary</h3>
  <ul id="creditSummary"></ul>

  <h3>Semester GPA</h3>
  <ul id="gpaSummary"></ul>

  <h3>CGPA</h3>
  <p id="cgpa"></p>

  <h3>Planning Credits</h3>
  <form id="planForm">
    Max Professional: <input type="number" id="maxProfessional" value="232"><br>
    Max Free: <input type="number" id="maxFree" value="42"><br>
    Max Engineering: <input type="number" id="maxEngineering" value="57"><br>
    Max Science: <input type="number" id="maxScience" value="102"><br>
    Max Humanities: <input type="number" id="maxHumanities" value="27"><br>
    <button type="submit">Check Plan</button>
  </form>
  <ul id="planSummary"></ul>

  <script>
    const gradeMap = { S: 10, A: 9, B: 8, C: 7, D: 6, E: 4, F: 0 };
    const courses = [];

    document.getElementById('courseForm').addEventListener('submit', e => {
      e.preventDefault();
      const name = courseName.value;
      const credits = +creditsInput.value;
      const grade = gradeLetter.value;
      const category = categoryInput.value;
      const semester = semesterInput.value;

      const point = gradeMap[grade] || 0;
      const course = { name, credits, grade, point, category, semester };
      courses.push(course);
      render();
    });

    document.getElementById('planForm').addEventListener('submit', e => {
      e.preventDefault();
      render();
    });

    function render() {
      const tbody = document.querySelector('#courseTable tbody');
      tbody.innerHTML = '';
      courses.forEach(c => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${c.name}</td><td>${c.credits}</td><td>${c.grade}</td>
                        <td>${c.category}</td><td>${c.semester}</td><td>${c.point}</td>`;
        tbody.appendChild(tr);
      });

      // Credit Summary
      const creditCount = {};
      courses.forEach(c => {
        creditCount[c.category] = (creditCount[c.category] || 0) + c.credits;
      });

      const categories = ['Professional', 'Free', 'Engineering', 'Science', 'Humanities'];
      const summaryUl = document.getElementById('creditSummary');
      summaryUl.innerHTML = '';
      categories.forEach(cat => {
        const li = document.createElement('li');
        li.textContent = `${cat}: ${creditCount[cat] || 0}`;
        summaryUl.appendChild(li);
      });

      // GPA per semester
      const semMap = {};
      courses.forEach(c => {
        if (!semMap[c.semester]) semMap[c.semester] = [];
        semMap[c.semester].push(c);
      });

      const gpaUl = document.getElementById('gpaSummary');
      gpaUl.innerHTML = '';
      let totalPoints = 0, totalCredits = 0;
      for (const [sem, list] of Object.entries(semMap)) {
        let points = 0, credits = 0;
        list.forEach(c => {
          points += c.point * c.credits;
          credits += c.credits;
        });
        totalPoints += points;
        totalCredits += credits;
        const gpa = (points / credits).toFixed(2);
        const li = document.createElement('li');
        li.textContent = `${sem}: GPA = ${gpa}`;
        gpaUl.appendChild(li);
      }

      // CGPA
      document.getElementById('cgpa').textContent = totalCredits ? `CGPA = ${(totalPoints / totalCredits).toFixed(2)}` : "N/A";

      // Planning
      const max = {
        Professional: +document.getElementById('maxProfessional').value,
        Free: +document.getElementById('maxFree').value,
        Engineering: +document.getElementById('maxEngineering').value,
        Science: +document.getElementById('maxScience').value,
        Humanities: +document.getElementById('maxHumanities').value,
      };

      const planned = { ...creditCount };
      const overflow = {};
      categories.forEach(cat => {
        if (planned[cat] > max[cat]) {
          overflow[cat] = planned[cat] - max[cat];
        }
      });

      const planUl = document.getElementById('planSummary');
      planUl.innerHTML = '';
      categories.forEach(cat => {
        const li = document.createElement('li');
        let text = `${cat}: ${planned[cat] || 0}`;
        if (cat !== 'Free') {
          if ((overflow[cat] || 0) > 0) {
            text += ` â†’ Free (-${overflow[cat]})`;
          }
        }
        li.innerHTML = text;
        if (overflow[cat]) li.classList.add('overflow');
        planUl.appendChild(li);
      });
    }

    const courseName = document.getElementById('courseName');
    const creditsInput = document.getElementById('credits');
    const gradeLetter = document.getElementById('gradeLetter');
    const categoryInput = document.getElementById('category');
    const semesterInput = document.getElementById('semester');
  </script>
</body>
</html>
